CREATED BY: Kwabena Adu - Tekyi

---

## StackRot Vulnerability Check Script

This script checks if the installed Linux kernel version on your system is vulnerable to CVE-2023-3269 (StackRot). It compares your kernel version against a known vulnerable range.

### Script Breakdown

1. **Shebang**:

   ```bash
   #!/bin/bash
   ```

   Specifies that the script should be executed using the Bash shell.

2. **Function to Check Command Existence**:

   ```bash
   command_exists() {
       command -v "$1" >/dev/null 2>&1
   }
   ```

   Checks if a command is available in the system's `PATH`. It returns success (`0`) if the command exists or failure (`1`) if it doesn't.

3. **Check for `uname` Command**:

   ```bash
   if ! command_exists uname; then
       echo "'uname' command not found. Please ensure you have the necessary tools installed."
       exit 1
   fi
   ```

   Verifies the presence of the `uname` command, which is necessary to determine the kernel version. If missing, it prompts the user to install the required tools.

4. **Retrieve Kernel Version**:

   ```bash
   kernel_version=$(uname -r | cut -d '-' -f 1)
   echo "Installed kernel version: $kernel_version"
   ```

   Executes `uname -r`, extracts the version number, and stores it in `kernel_version`. The version is then printed.

5. **Define Vulnerable Version Range**:

   ```bash
   vulnerable_min_version="5.10.0"
   vulnerable_max_version="5.10.12"
   ```

   Sets the range of Linux kernel versions that are vulnerable to CVE-2023-3269.

6. **Version Comparison Function**:

   ```bash
   version_compare() {
       if [ "$1" = "$2" ]; then
           return 0
       fi

       local IFS=.
       local i version1=($1) version2=($2)

       for ((i=${#version1[@]}; i<${#version2[@]}; i++)); do
           version1[i]=0
       done

       for ((i=${#version2[@]}; i<${#version1[@]}; i++)); do
           version2[i]=0
       done

       for ((i=0; i<${#version1[@]}; i++)); do
           if [ "${version1[i]}" -lt "${version2[i]}" ]; then
               return 1
           elif [ "${version1[i]}" -gt "${version2[i]}" ]; then
               return 2
           fi
       done

       return 0
   }
   ```

   Compares two version strings. Returns `0` if equal, `1` if the first is smaller, and `2` if the first is larger.

7. **Check Vulnerability**:

   ```bash
   version_compare "$kernel_version" "$vulnerable_min_version"
   min_compare=$?

   version_compare "$kernel_version" "$vulnerable_max_version"
   max_compare=$?

   if [ $min_compare -eq 2 ] && [ $max_compare -eq 1 ]; then
       echo "Your system is vulnerable to CVE-2023-3269 (StackRot). Please update your kernel."
       echo "Visit your Linux distribution's website for instructions on updating your kernel."
   else
       echo "Your system is not vulnerable to CVE-2023-3269 (StackRot)."
   fi
   ```

   Compares the installed kernel version against the vulnerable range. If it falls within the range, the script warns about the vulnerability; otherwise, it confirms the system is safe.

### Usage

Run the script on your system to determine if you are vulnerable to CVE-2023-3269 and take appropriate action based on the output.
